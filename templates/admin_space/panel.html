<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin panel</title>
    <link rel="stylesheet" href="/static/admin_space/css/panel.css">
</head>
<body>
    <div class="panel">
        <div class="search_engine">
            <div class="searchbar_form_and_title">
                <h2 id="searchbar_title">Rechercher une JA :</h2>
                <form action="/admin_space/panel" method="get" class="searchbar_form">
                    <input type="text" name="searchbar" id="searchbar" placeholder="ja-8166, 8166, devlowave, devlowave.devlowave.fr" value="{% if search_results["query"] %}{{ search_results["query"] }}{% endif %}">
                    <input type="submit" name="searchbar_submit_button" id="searchbar_submit_button" value="Rechercher">
                    <button id="back_button"><a href="/admin_space/panel">Retourner à la liste</a></button>
                </form>
            </div>
            <div class="results">
                <h3 id="results_title">Résultat(s) :</h3>
                <div class="search_results">
                    {# If error #}
                    {% if search_results["results"]["result_1"]["error"] == "error" %}
                        <div class="search_error">
                            {{ search_results["results"]["result_1"]["content"] }}
                        </div>
                    {% else %}
                    {# If there's an actual result #}
                    {% for key, result in search_results["results"].items() %}
                            <form action="/admin_space/panel" method="get">
                                <div class="search_result_content">
                                    <input type="hidden" name="ja_selector_id" value="{{ result["id"] }}">
                                    <div class="svg_dash_and_result">
                                        <img src="/static/admin_space/images/status_{{ result["status"] }}_indicator.svg" alt="status{{ result["status"] }}" id="status_indicator_svg">
                                        <div id="result_dash">-</div>
                                        <input type="submit" name="ja_selector_{{ result["id"] }}" id="ja_selector" value="{{ result["name"] }},ja-{{ result["id"] }}, {{ result["subdomain"] }}">
                                    </div>
                                {# Overwrite the original css from panel.css so if the ja is selected it's background is yellow and the other hover color is now blue #}
                                <style>
                                {% if result["is_selected"] == True %}
                                    input[name="ja_selector_{{ result["id"] }}"] {
                                        background-color: yellow !important;
                                    }

                                    #ja_selector:hover{
                                        background-color: deepskyblue;
                                    }
                                {% endif %}
                                </style>
                            </div>
                        </form>
                    {% endfor %}
                {% endif %}
                </div>
            </div>
        </div>
        <div class="website_details">
            <h2 id="details_area_title">Détails du site :</h2>
            {% if website_details %}
                <div class="ja_id_and_name">
                    ID : {{ website_details["id"] }} <br>
                    Nom : {{ website_details["name"] }} <br>
                </div>
                <div class="ja_website_subdomain_and_status">
                        <img src="/static/admin_space/images/status_{{ website_details["status"] }}_indicator.svg" alt="status{{ website_details["status"] }}" id="website_details_status_indicator_svg">
                        <div id="result_dash">-</div>
                        Sous domaine : {{ website_details["subdomain"] }}
                </div>
                {% if website_details["status"] == 2 %}
                    Cette Ja a demandé une review, lien : "{{ website_details["preview_link"] }}"
                    <form class="website_demand_acceptor" action="/admin_space/panel?searchbar={{ website_details["id"] }}" method="post">
                        {% if website_details["host_demand"] == False %}
                            <br>Raison :<br>
                            <textarea name="reject_message" placeholder="Le texte entré ici sera envoyé par mail à cette JA"></textarea><br>
                            <input type="submit" name="reject_button" value="Rejeter">
                        {% else %}
                            <input type="submit" name="accept_button" value="Accepter">
                            <input type="submit" name="reject_button" value="Rejeter">
                        {% endif %}

                    </form>
                {% endif %}
            {% else %}
                <p>Pas de JA selectionnée</p>
            {% endif %}
        </div>
    </div>
</body>
</html>